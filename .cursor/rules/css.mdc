---
description: Accessible CSS patterns and conventions
globs: "*.css"
alwaysApply: true
---

# CSS Conventions — Accessibility & Best Practices

Apply these rules when writing or modifying any CSS in this project.

## Focus styles

- Always define `:focus-visible` styles for interactive elements.
- Never use `outline: none` or `outline: 0` without providing an alternative visible focus indicator.
- Focus indicators must have at least 3:1 contrast against adjacent colors.

## Motion and animation

- Wrap all animations and transitions in a `prefers-reduced-motion` check:
  ```css
  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
  ```

## Units and sizing

- Use `rem` or `em` for font sizes to support browser zoom (never `px` for body text).
- Use typography token variables (`--font-size-*`, `--font-weight-*`, `--line-height-*`, `--letter-spacing-*`) instead of raw values wherever possible.
- Ensure interactive touch targets are at least 24x24 CSS pixels (WCAG 2.1 AA).
- Content must be readable and functional at 200% browser zoom.

## Color

- Do not rely on color alone to convey meaning; pair with icons, underlines, or text.

## Hidden content

- Use this pattern for visually-hidden-but-screen-reader-accessible text:
  ```css
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
  ```

## Design tokens

- All CSS custom properties (`--*`) live in `styles/tokens/`:
  - `colors.css` — color palette and semantic color tokens
  - `typography.css` — font family, size, weight, line-height, letter-spacing tokens
  - `spacing.css` — spacing scale tokens
  - `breakpoints.css` — responsive breakpoint tokens (sm, md, lg, xl, 2xl)
- Never declare `--*` variables in `globals/` or `sections/` CSS files.
- CSS reset lives in `globals/reset.css` (Andy Bell's "(more) Modern CSS Reset"). Do not add reset rules elsewhere.
- Element-level typography styles live in `globals/typography.css`.
- Layout primitives (`.container`, `.vstack`, `.hstack`) live in `globals/layout.css`. Use BEM modifiers for gap sizes (`--xs` to `--xl`) and alignment (`--center`, `--stretch`).
- Reusable UI component styles (button, link, menu) live in `components/`. Import order in `main.css`: globals → components → sections.
- Page-level partials live in `sections/`.
- Use `@custom-media` names (e.g. `@media (--screen-md)`) for breakpoints in media queries. These are compiled at build time by `postcss-custom-media`. Do not use `var()` in media query conditions — it doesn't work at runtime.

## postcss-nested

- This project uses `postcss-nested`. Prefer nesting for component scoping:
  ```css
  .hero {
    & .hero__title { ... }
    & .hero__subtitle { ... }
  }
  ```
